%h1= "Event: #{@event.name}"

%h2= "Periods:"
%ul.event_periods
  - @event.event_generators.each do |event_generator|
    %li
      %strong Started:
      = event_generator.start_date

      - if event_generator.end_date
        %strong Ended:
        = event_generator.end_date
      - else
        = link_to "End period", edit_event_generator_path(event_generator), class: "button tiny alert"

%h2= "Instances:"
%ul.event_instances
  - @event.event_instances.each do |event_instance|
    %li.row
      .small-10.medium-8.columns
        = link_to event_instance.date, event_instance.url
        %strong Venue:
        = event_instance.venue.name
      .small-2.medium-4.columns.actions
        - if event_instance.cancelled?
          = cancellation_button_for event_instance, false, class: "button tiny un-cancel" do
            %span.button-text Cancelled
            %i.fi-check
        - else
          = cancellation_button_for event_instance, true, class: "button tiny warn cancel" do
            %span.button-text Cancel
            %i.fi-x

        -# TODO: when jquery-rails > 3.1.1 is released, we can add the following:
        -#    data: { confirm: "Are you sure you want to delete this instance?" }
        -#  Currently there's a bug whereby the event handler gets applied twice, and blocks the deletion from happening
        = button_to event_instance_path(event_instance), class: "button tiny alert delete", method: :delete do
          %span.button-text Bin
          %i.fi-trash

= link_to new_event_date_path(@event), class: "button" do
  Add date
  %i.fi-calendar
